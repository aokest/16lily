以下计划严格按照“先定位问题→可复现→可验证”的流程，使用 AGENTS.md 中的 webapp-testing 技能进行自动化调试，并给出最小代码修复方案与验证步骤。

## 使用技能
- 选择技能：webapp-testing（Playwright 自动化测试与前端行为验证）。
- 作用：在本机自动打开 http://127.0.0.1:8000/crm 的编辑器页面与导航栏，模拟点击、读取 DOM、计算样式、截图留证，复现并定位问题。

## 问题与调试目标
1. 样式编辑按钮（左上角“主题/样式”）点击后下拉是否出现；若未出现，判断是：
   - 事件未触发（状态未变）
   - DOM 已渲染但被裁切（overflow）或被遮挡（z-index）
   - 位置计算错误（absolute 参照系不正确）
2. 右下角“输出物”栏目是否存在 DOM；若存在但不可见，读取其 boundingClientRect 判断是否高度为 0 或 display:none；若布局传递高度失败，定位是哪一层未拉伸。
3. 通知铃铛下拉是否能展示最近 10 条；若空，判断 localStorage 数据状态并验证排序逻辑。

## 自动化调试（只读）
- 新建 Playwright 脚本（webapp-testing 指南将给出模板），场景：
  1) 进入独立卡片编辑器路由 /standalone/card/:id（避免侧边栏影响），点击“主题”按钮：
     - 断言：出现 class=“absolute ...”的菜单；失败时：
       - 读取 showThemeMenu 的值（通过 window.__debug hooks 或 data-state 属性）
       - 获取菜单元素的 computedStyle（overflow、z-index、display）
       - 截图 toolbar 与菜单区域
  2) 在卡片预览内查找“输出物”标题，获取其父容器高度：
     - 断言：父容器高度 > 160px（可设下界）；失败时：
       - 读取祖先节点高度链（grid→col→flex）
       - 记录每层的 overflow 与 height/min-height 设置
  3) 点击铃铛：
     - 若 localStorage["crm_manager_messages"] 不存在或 []，记录并注入 mock（本步仅测试环境）
     - 断言：列表项 >= 1，标题按时间倒序；截图留证。

## 修复方案（最小改动）
1. 样式菜单稳妥方案：使用 Teleport 将下拉菜单挂载到 body（避免任何父级 overflow/z-index 干扰），定位使用 getBoundingClientRect 绝对定位。
2. 输出物布局稳妥方案：右列采用显式栅格行：grid-rows-[auto,auto,1fr]；输出物容器设为 row-3 且 h-full；祖先 grid 保证 h-full，使高度传递稳定。
3. 通知下拉数据稳妥方案：读取 localStorage 后若为空数组也走默认 mock； recentMessages 统一排序 slice(0,10)。

## 验证与留证
- 运行 webapp-testing 脚本：自动化点击、读取样式、截图（菜单展开截图、输出物高度截图、通知列表截图）。
- 本地人工验证：
  - 打开 /standalone/card/:id
  - 点击“主题”，观察菜单展开；
  - 查看卡片右下“输出物”是否存在且与左列底部对齐；
  - 点击铃铛，查看 10 条最近消息与“更多通知消息”。

## 交付
- 提供调试脚本与测试截图；
- 按上述修复方案提交最小代码改动，并再次跑自动化测试确认通过。