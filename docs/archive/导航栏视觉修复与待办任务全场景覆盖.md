关于**导航栏层次**：
虽然我已经注入了 CSS 代码来添加分组标题，但可能因为 Jazzmin 的模板加载机制（`base_site.html` 可能未被正确加载，或者 CSS 选择器未命中），导致视觉分组没有生效。我会：
1.  **强化 CSS 选择器**：使用更通用的选择器，并添加 `!important` 确保样式生效。
2.  **检查模板路径**：确保 `backend/templates/admin/base_site.html` 被正确加载。
3.  **Plan B (Proxy Model + Multiple Apps)**：如果 CSS 方案持续不稳定，我将不得不采用最“正统”但繁琐的方案——创建真正的 Django App（或使用 Proxy Model 指向不同的 AppConfig）来让 Jazzmin 原生识别分组。鉴于 CSS 方案简单且无侵入性，我再试一次强化版的 CSS。

关于**待办任务的 4 种生成途径**：
这是一个非常好的业务逻辑完善需求。目前系统已经有了基础的 `TodoTask` 模型，我们需要扩展它以支持这 4 种场景：

1.  **流程审核触发** (已部分实现，需完善)：
    *   我们已经在 `Announcement` 中实现了发布审核。需要扩展到“项目建立”（即商机/赛事的创建）。
    *   **Action**: 监听 `post_save` 信号，当 Opportunity/Competition 创建且状态为 `PENDING` 时，自动生成待办给审批人。

2.  **用户自建** (已支持)：
    *   Django Admin 原生支持 `add` 操作。
    *   **Action**: 优化 `TodoTaskAdmin`，确保用户创建时默认 `assignee` 为自己（除非有权限指派）。

3.  **上级指派** (需增强)：
    *   目前 Admin 允许选择 `assignee`。
    *   **Action**: 增加权限控制，只有“经理”或“管理员”角色的用户在创建任务时可以选择 `assignee`，普通用户只能选自己。

4.  **AI 解析文本生成** (🔥 新功能)：
    *   **Action**: 在 `TodoTask` 的 Admin 页面增加一个自定义 **Action** 或 **Form 按钮**：“AI 智能解析”。
    *   **交互**: 用户弹窗输入一段自然语言（如“下周五前把招标文件发给张总”），后台调用简单的 NLP 逻辑（这里先用正则或简单规则模拟，因为没有接入真实 LLM API）自动填充 `title`, `deadline`, `description`。

---

## 📅 执行计划

### **Phase 1: 导航栏视觉修复 (优先级最高)**
1.  **强化 CSS**：修改 `base_site.html`，使用更强的选择器（例如基于 `fa-icon` 类名或 `href` 属性），并确保背景色对比度足够。
2.  **验证模板**：确认 `TEMPLATES` 配置中 `DIRS` 包含了 `backend/templates`。

### **Phase 2: 待办任务功能升级**
1.  **模型增强**：在 `TodoTask` 中增加 `source_type` 字段（自建、流程、指派、AI生成），便于追踪来源。
2.  **信号完善**：
    *   完善 `Opportunity` 和 `Competition` 的 `post_save` 信号，触发审核任务。
3.  **Admin 权限优化**：
    *   重写 `TodoTaskAdmin.get_form`，根据用户角色限制 `assignee` 字段的选择范围。
4.  **AI 解析功能**：
    *   实现一个简单的自然语言解析函数 `parse_todo_text(text)`。
    *   在 Admin 中添加一个“AI 快速创建”页面或按钮。

### **Phase 3: AI 解析实现细节**
*   我们将实现一个自定义的 Admin View `add_by_ai`。
*   用户输入文本，后端解析：
    *   **时间识别**：识别“明天”、“下周三”、“2025-01-01”等，转换为 `deadline`。
    *   **动作识别**：识别动词作为 `title`。
    *   **指派人识别**：尝试匹配系统用户名（如“给张三”）。

Let's start fixing the Sidebar first, then build the Todo features.