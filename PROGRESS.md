# 项目开发进度与总结 (PROGRESS.md)

## 📌 当前版本：v1.2.1
**日期**：2026-01-08
**状态**：Stable (修复了项目详情页白屏、AI 润色无效问题，增强了分场景 AI 提示词)

---

## 🚀 开发进度 (Development Progress)

### 1. 核心功能迭代 (2026-01-08)
- **项目管理**：
    - 修复了 `ProjectViewSet` 导入漏洞导致的后端 500 错误，解决了前端无法显示新创建项目的问题。
    - 增强了项目软删除逻辑。
    - **[v1.2.1] 修复项目详情页白屏**：解决 Docker 环境下路径别名失效问题。
- **AI 智能助手**：
    - **[v1.2.1] 分场景润色**：基于用户角色（研发/销售/管理）自动切换 Prompt，强制重写以提升润色效果。
    - 修复了 AI 配置未激活导致的服务静默失效。
- **通知系统**：
    - 编写并集成了 `clean_notifications` 命令，支持清理指向“已删除”或“已软删除”对象的通知，解决小铃铛脏数据问题。
- **AI 配置管理**：
    - 修复了 `AIConfigurationViewSet` 的用户隔离问题，确保“设为默认”仅影响当前用户的配置。
- **数据管理**：
    - 修复了备份/恢复功能在容器环境下的解释器路径问题。

---

## 🛠 问题整理 (Issue Tracking)

| 问题描述 | 根本原因 | 解决方案 |
| :--- | :--- | :--- |
| 创建项目后前端不显示 | `ProjectViewSet` 内部局部导入导致 Scope 错误 (500) | 将 `from .models import ...` 移出类定义或移入具体方法 |
| 小铃铛显示已删除对象的通知 | 通知记录指向了已物理删除或软删除的对象 | 增加 `clean_notifications` 管理命令定期清理无效引用 |
| AI 配置设为默认影响他人 | `set_default` Action 缺少 `.filter(user=request.user)` | 增加用户过滤逻辑，确保操作的原子性和隔离性 |
| 数据备份失败（/tmp/backup 为空） | `subprocess.run` 默认使用系统 python 而非 venv 环境 | 使用 `sys.executable` 动态获取当前 Python 路径 |

---

## 📅 下一步规划 (Future Roadmap)

1. **CRM 业务深度扩展**：
    - 完善客户标签系统与公海池逻辑。
    - 增加商机转项目的全链路审批流。
2. **AI 功能深化**：
    - 集成 DeepSeek/Gemini 的 Vision 能力，支持分析项目进度截图。
    - 增加“AI 业绩预测”看板。
3. **系统稳定性**：
    - 增加关键业务逻辑的单元测试。
    - 优化云端 2C/2G 低配服务器的内存占用。
